pipeline{
        agent any
        stages{
            stage('Run App'){
                steps{
                      sh """
                     ssh -i ~/id_rsa tinokingstone@51.140.240.158 <<EOF
                    
                    export MY_SECRET_KEY=root
                    export PWD_ROOT=password              
                    rm -rf mvp
                    mkdir mvp                    

                    cd mvp
                    git init
                    git clone https://github.com/tinokingstone/qa_project_two.git
                    cd qa_project_two
                    git checkout game_app
                    docker stack deploy --compose-file docker-compose.yaml survive
                    """
               }
            }
        }    
}

